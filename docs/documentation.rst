4.3 refine_events
=================

Events table (Astropy FITS table)
=================================

The output here is very similar to the candidate events table. In fact, part of it is completely duplicated. All tags listed in the event candidates table are also part of the events table. However, the following columns are also appended.  NOTE: the entries for u0 and t0 are *overwritten*; the values for u0 and t0 returned from calc_events is different from that returned in refine_events. Each refine_events file requires you to choose a filter and extinction law; in this table we suppose filter *x* is chosen.

+-------------+----------------------------------------------+--------------+
|Tag name     |Brief Description                             |Units         |
+=============+==============================================+==============+
|u0           |(Unitless) minimum source-lens separation,    |dim'less      |
|             |*during* the survey                           |              |
+-------------+----------------------------------------------+--------------+
|t0           |Time at which minimum source-lens separation  |days          |
|             |occurs                                        |              |
+-------------+----------------------------------------------+--------------+
|delta_m_x    |Bump amplitude (difference in baseline and    |mag           |
|             |maximum magnification magnitude) in *x*-band  |              |
+-------------+----------------------------------------------+--------------+
|pi_rel       |Relative parallax                             |mas           |
+-------------+----------------------------------------------+--------------+
|pi_E         |Microlensing parallax.                        |dim'less      |
+-------------+----------------------------------------------+--------------+
|t_E          |Einstein crossing time                        |days          | 
+-------------+----------------------------------------------+--------------+
|ubv_x_app    |UBV photometric system, *x*-band apparent     |mag           |
|(_L, _S)     |magnitude, with extinction                    |              |                        
+-------------+----------------------------------------------+--------------+
|ubv_x_LSN    |Blended magnitude in *x* band (Apparent       |mag           |
|             |magnitude of source + lens + neighbors)       |              |
+-------------+----------------------------------------------+--------------+
|f_blend_x    |Source flux fraction (unlensed source flux    |dim'less      |             
|             |divided by baseline) in *x*-band              |              |
+-------------+----------------------------------------------+--------------+
|cent_glon_x_N|Galactic longitude l of neighbor stars'       |deg           |             
|             |centroid                                      |              |
+-------------+----------------------------------------------+--------------+
|ubv_x_app_N  |Apparent magnitude of neighbor stars, *x*-band|mag           |             
|             |apparent magnitude                            |              |
+-------------+----------------------------------------------+--------------+

4.4 Additional descriptions of tags
===================================

**rem_id** These label the different types of remnant objects (star, black hole, neutron star, or white dwarf.) They are identified as following:

* 0: Star
* 101: WD
* 102: NS
* 103: BH

**popid** Describes which population is generated [#f2]_. They are identified as following:

* 0: Thin disk, ≤ 0.15 Gyr
* 1: Thin disk, 0.15-1 Gyr
* 2: Thin disk, 1-2 Gyr
* 3: Thin disk, 2-3 Gyr
* 4: Thin disk, 3-5 Gyr
* 5: Thin disk, 5-7 Gyr
* 6: Thin disk, 7-10 Gyr
* 7: Thick disk, 11 Gyr (single-age)
* 8: Stellar halo, 14 Gyr (single-age)
* 9: Bulge, 10 Gyr (single-age)

**px, py, pz; vx, vy, vz** These are given in heliocentric coordinates (i.e. Cartesian coordinates with the sun at the origin.) See subsection on coordinate systems for more information.

**rad, glat, glon; vr, mu_b, mu_lcosb** These are given in galactic coordinates (i.e. spherical coordinates with the sun at the origin.) See subsection on coordinate systems for more information.

**ubv_u, b, v, r, i, j, h, k; exbv** Photometry information is given in absolute magnitude. For NSs and BHs, all these values are nan to indicate they are dark.

**t0** Note that you can have a negative day (this just means time before the "zero" time, which is defined as the state of the system that is generated by Galaxia and the population synthesis. Since we are assuming everything moves in straight lines, we can propagate either forward or backwards.



.. rubric:: Footnotes

.. [#f2] In Galaxia there is an option for a 10th population type; the Bullock and Johnston stellar halos. We have chosen not use it, and the code is not written to include it.

5 Coordinates System
=====================

There are two different coordinate systems used, Heliocentric and Galactic. 
Heliocentric coordinates are Cartesian coordinates with the sun at the origin. The positive *x* axis is pointing toward the Galactic Center, and the positive *z* axis is pointing toward the Galactic North Pole.
Galactic coordinates are spherical coordinates with the sun at the origin. 
Longitude *l* is measuring the angular distance of an object eastward along the galactic equator from the galactic center, and latitude *b* is measuring the angle of an object north or south of the galactic equator (or midplane) as viewed from Earth; positive to the north, negative to the south. 
Radius *r* is the distance from the sun to the object. 

The conversion between Heliocentric and Galactic is just the same as converting between rectangular to spherical coordinates, where *φ = l* and *θ = -b + 90*.
Going from Galactic to Heliocentric (units are degrees):

                       x = r*sin(−b+ 90)cos(l) = r*cos(b)cos(l) 
                    
                       y = r*sin(−b+ 90)sin(l) = r*cos(b)sin(l)
  
                       z = r*cos(−b+ 90) = r*sin(b)

Going from Galactic to Heliocentric (units are degrees):

                       r = (x2+y2+z2)^(1/2)

                       b = −arccos(z/r) + 90
 
                       l = arctan(y/x)

Note: be careful with the branch of arctangent. Practically, use numpy.arctan2 if using Python.


 

.. figure:: coords.png
    :width: 200px
    :align: center
    :height: 100px
    :alt: alternate text
    :figclass: align-center

    Figure 2: Diagram of Heliocentric and Galactic coordinate systems. The red dot is the sun.
